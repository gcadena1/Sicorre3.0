<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.css">
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css">
    {%load static %}
    <script src="{% static 'js/tcal.js' %}"></script>
    <title>Facturación Consultas</title>
</head>
<style>
    th {
        background-color: #930708;
        background-repeat: repeat-x;
        color: #ffffff;
        font-size: 11px;
        border-width: 0px;
        font-weight: bold;
        width: 149px;
    height: 38px;
    }
    select{
      margin-top: 10px;
      margin-bottom: 10px;
    }
    #renglon1 {
        border-style: groove;
        border-color: #000000;
        border-width: 0px;
        background-color: #EEE;
        margin-top: 10px;
        filter: alpha(opacity=90);
        opacity: .9;
        font-size: 12px;
    }
    table {
        border-collapse: separate;
        text-indent: initial;
        border-spacing: 2px;
    }
</style>
<body>
    <form onsubmit="return processForm()">
        <table>
            <tr>
                <td width="405">
                    <select name="" id="emisor" style="width:350px;" >
                        <option   value="">Emisor (Todos)</option>
                        {% for rfcEmisor, emisor in resultados %}<option value="{{rfcEmisor}}">{{ emisor }}</option>
                        {% empty %} <option value="">No hay datos</option>
                        {% endfor %}
                    </select>


                  
                <td colspan="3">Buscar por fecha
                    De: &nbsp;&nbsp;&nbsp;
                    <?php //echo$fechaDE = $_POST['fechaDE']; ?>
                    <input type="text" name="fechaDE"  size="10" id="fechaDE" value="" class="tcal tcalInput" autocomplete="off" />
                    &nbsp;&nbsp;&nbsp;A:&nbsp;&nbsp;&nbsp;
                    <input type="text" name="fechaA" size="10" id="fechaA" value="" class="tcal tcalInput" autocomplete="off" />
                </td>
                </td>
                <td width="320">
                    <input type="submit" name="Buscar" id="Buscar" value="Buscar" />
                </td>
            </tr>
            <tr>
                <td height="46">
                    <select name="" id="receptor" style="width:350px;" >
                        <option value="">Receptor (Todos)</option>
                        {% for reporte in resultadosReceptor %}<option value="{{  reporte.1 }}">{{ reporte.1 }} [{{reporte.0}}]</option> {% endfor %}
                    </select>
                </td>
                <td width="97"><b>Referencia</b></td>
                <td width="212"><input type="text" name="referencia" id="referencia" value=""/></td>
                <td width="144"><select name="status" id="status">
                    <option value="Todos" >Estado(Todos)</option>
                    <option value="Activo">Activo</option>
                    <option value="Cancelado">Cancelado</option>
                  </select>
                </td>
                <td>
                    <label for="estado">
                        {% load static %}
                        <img src="{% static 'image/xml.png'%}" height="30" width="30">
                        <input name="xml" type="checkbox" id="xml"/>
                      &nbsp;&nbsp;&nbsp;
                         {% load static %} 
                        <img   name="pdf2" id="pdf2" src="{%static 'image/pdf.jpg' %}" height="30" width="30" />
                        <input type="checkbox" name="pdf" id="pdf"/>
                      &nbsp;&nbsp;&nbsp;
                    ITEM
                        <input  type="checkbox" name="registros" id="registros"/>
                     &nbsp;&nbsp;&nbsp;
                    Pagos
                        <input type="checkbox" name="complePagos" id="complePagos"/>
                        &nbsp;&nbsp;&nbsp;
                      <br>
                    E-mail
                        <input type="checkbox" name="email" id="email">
                        <input style="display:none;" type="checkbox" name="gastosReembolsables" id="gastosReembolsables">
                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    Desgloses
                      <input type="checkbox" name="desgloses" id="desgloses">
                    </label>
                </td>
            </tr>
            <tr id="renglon1">
                <td colspan="3"><b>UUID</b><br>
                <label for="textfield"></label>
                <textarea name="uuid" id="uuid" cols="62" rows="2"></textarea>
            </td>
            <td colspan="2">
                <b>Serie y Folio</b><textarea name="serieFolio" id="serieFolio" cols="35" rows="1"></textarea>

            </td>
            </tr>
            <tr>
                <td align="left" colspan="5" id="renglon1"><b>Nota:</b>Para Realizar <b>multiples busquedas</b> de Serie y folios o UUID separe cada dato con una coma y sin espacios. <strong></strong></td>
            </tr>
             <tr>
                <td colspan="5" align="left">
                    Buscar clave producto
                    <input type="text" name="dentroConcepto" id="dentroConcepto" value="">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <select name="tipoFiltro" id="tipoFiltro">
                        <option value=""></option>
                        <option value="AND">Y</option>
                        <option value="OR">O</option>
                    </select>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    Buscar palabra en concepto
                    <input type="text" name="fillConcepto" id="fillConcepto">
                </td>
             </tr>
        </table>
    </form>
    <table id="table_ejemploList" class="table table-striped table-bordered">
        <thead>
            <tr bgcolor="#bee5eb">
                <th>Usuario</th>
                <th>Fecha</th>
                <th>Referencia</th>
                <th>UUID</th>
                <th>Serie</th>
                <th>Folio</th>
                <th>Emisor</th>
                <th>Receptor</th>
                <th>R.F.C</th>
                <th>OTRAS EROGACIONES</th>
                <th>HONORARIOS</th>
                <th>SUBTOTAL</th>
                <th>DESCUENTO</th>
                <th>IVA</th>
                <th>RETENCIÓN ISR</th>
                <th>IEPS</th>
                <th>ImpEstatal</th>
                <th>TOTAL</th>
                <th>MONEDA</th>
                <th>T/C</th>
                <th>ESTATUS</th>
                <th>REEMBOLSABLES</th>
                <th>Web Services</th>
            </tr>
        </thead>
              
        {% for report in reports %}
        <tr class="text-center">
            <td>{{ report.id_usuario }} </td>
            <td>{{ report.fecha }} </td>
            <td>{{ report.referencia}} </td>
            <td>{{ report.uuid}} </td>
            <td>{{ report.serie}} </td>
            <td>{{ report.consecutivo}} </td>
            <td>{{ report.emisor }} </td>
            <td>{{ report.receptor }} </td>
            <td>{{ report.urlpdf }} </td>
            <td>{{ report.rfcEmisor }} </td>
   
        </tr>
    {% endfor %}
 
      
    </table>
    <script src="//code.jquery.com/jquery-1.12.4.js"></script>
    <script src="//cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="//cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script>
    <script>
    function processForm() {
        let emisor = document.getElementById("emisor").value;
        let receptor = document.getElementById("receptor").value;
        let fechaDE = document.getElementById("fechaDE").value;
        let fechaA = document.getElementById("fechaA").value;
        let referencia = document.getElementById("referencia").value;
        let status = document.getElementById("status").value;
        let xmlChecked = document.getElementById("xml").checked;
        let pdfChecked = document.getElementById("pdf").checked;
        let registrosChecked = document.getElementById("registros").checked;
        let complePagosChecked = document.getElementById("complePagos").checked;
        let emailChecked = document.getElementById("email").checked;
        let desglosesChecked = document.getElementById("desgloses").checked;
        let uuid = document.getElementById("uuid").value;
        let serieFolio = document.getElementById("serieFolio").value;
        let dentroConcepto = document.getElementById("dentroConcepto").value;
        let tipoFiltro = document.getElementById("tipoFiltro").value;
        let fillConcepto = document.getElementById("fillConcepto").value;
        console.log("--"+fillConcepto);
        table = $('#table_ejemploList');
        if(pdfChecked==true){
            table.find('thead tr').each(function(){
                var trow = $(this);
                if(trow.index()===0){
                    trow.append('<th>PDF</th>');
                }else{
                }
            });
        }
        if(xmlChecked==true){
            table.find('thead tr').each(function(){
                var trow = $(this);
                if(trow.index()===0){
                    trow.append('<th >XML</th>');
                }else{
                }
            });
        }
        return false;
    }
    $(document).ready( function () {
        $('#table_ejemploList').DataTable();
    });
    </script>
</body>
</html>|